<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Óptica Yolanda — 3 Sucursales</title>
  <meta name="description" content="Catálogo y contactos de Óptica Yolanda. Elige la sucursal para ver dirección, horarios, WhatsApp y catálogo." />
  <link rel="icon" href="img/logo_optica_yolanda.png" />
  <style>
  :root{
    --rojo:#8b0000;
    --negro:#000000;
    --oro:#ffd700;
    --blanco:#ffffff;
    --gris:#cccccc;
  }
  /* Fondo con degradado + textura sutil */
  body{
    margin:0;
    font-family:"Poppins",system-ui,Segoe UI,Roboto,Ubuntu,Arial;
    background:
      linear-gradient(180deg,var(--rojo),var(--negro)),
      url("https://www.transparenttextures.com/patterns/dark-leather.png");
    background-blend-mode:overlay;
    background-size:cover;
    color:var(--blanco);
  }
  .container{max-width:1100px;margin:0 auto;padding:16px}
  /* Header boutique centrado */
  header{
    display:flex;flex-direction:column;align-items:center;justify-content:center;
    padding:25px 0 10px;text-align:center
  }
  header img{width:150px;height:auto;margin-bottom:10px;border-radius:8px;box-shadow:0 4px 20px rgba(0,0,0,.4)}
  header h1{margin:0;font-size:28px;letter-spacing:1px;font-weight:700;color:var(--oro)}
  .subtitle{font-size:14px;color:var(--gris)}
  .pill{background:rgba(255,255,255,.15);border:1px solid rgba(255,255,255,.25);padding:6px 10px;border-radius:999px;color:#fff;font-size:12px;margin-top:8px}
  /* Tabs */
  .tabs{display:flex;justify-content:center;flex-wrap:wrap;gap:10px;margin:16px 0}
  .tab{background:rgba(255,255,255,.12);color:#fff;border:1px solid rgba(255,255,255,.25);padding:8px 14px;border-radius:10px;cursor:pointer;font-weight:600;transition:all .2s}
  .tab:hover{background:rgba(255,255,255,.25)}
  .tab.active{background:var(--oro);color:#000;border-color:var(--oro)}
  /* Layout */
  .grid{display:grid;grid-template-columns:1.2fr .8fr;gap:18px}
  @media (max-width:960px){.grid{grid-template-columns:1fr}}
  /* Cards */
  .card{background:rgba(0,0,0,.4);border:1px solid rgba(255,255,255,.25);border-radius:16px;padding:18px;margin-bottom:18px;box-shadow:0 8px 25px rgba(0,0,0,.6);backdrop-filter:blur(6px)}
  .card h3{margin:0 0 10px}
  .muted{color:var(--gris)}
  /* Info */
  .info{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  @media (max-width:720px){.info{grid-template-columns:1fr}}
  /* Botones */
  .btn{display:inline-flex;align-items:center;gap:8px;background:var(--oro);color:#000;font-weight:700;border:0;border-radius:10px;padding:10px 14px;text-decoration:none;cursor:pointer;transition:all .2s}
  .btn:hover{background:#fff;box-shadow:0 0 10px var(--oro)}
  /* Productos */
  .products{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
  @media (max-width:960px){.products{grid-template-columns:repeat(2,1fr)}}
  @media (max-width:560px){.products{grid-template-columns:1fr}}
  .product{background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.25);border-radius:12px;overflow:hidden;transition:transform .2s,box-shadow .2s}
  .product:hover{transform:translateY(-3px);box-shadow:0 5px 20px rgba(255,215,0,.25)}
  .product img{width:100%;height:160px;object-fit:cover;display:block}
  .product .pbd{padding:12px}
  .price{color:var(--oro);font-weight:800;margin-top:4px}
  /* Form */
  .form-upload{margin-top:10px}
  .form-upload input,.form-upload button{padding:10px;margin:5px 0;border-radius:10px;border:1px solid rgba(255,255,255,.25);background:rgba(255,255,255,.1);color:#fff}
  .form-upload button{background:var(--oro);color:#000;border:0}
  input,textarea{background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.25);border-radius:10px;color:#fff;width:100%;padding:10px}
  input::placeholder,textarea::placeholder{color:#d6d6d6}
  /* Footer */
  footer{margin:26px 0 8px;color:#ddd;font-size:12px;display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap}
/* ==== Oro metálico premium + brillo sutil ==== */
:root{
  --oro1:#fff2a6;   /* luz */
  --oro2:#ffd34d;   /* medio */
  --oro3:#caa231;   /* sombra */
  --oro4:#8f6b00;   /* sombra profunda */
}

/* Título con degradado metálico animado */
header h1{
  background: linear-gradient(
    135deg,
    var(--oro1) 0%,
    var(--oro2) 30%,
    var(--oro3) 55%,
    var(--oro1) 70%,
    var(--oro4) 100%
  );
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  text-fill-color: transparent;
  background-size: 200% 100%;
  animation: goldSparkle 6s linear infinite;
  text-shadow: 0 1px 1px rgba(0,0,0,.35);
}

/* Línea delicada bajo el header para sensación “joyería” */
header{ border-bottom: 1px solid rgba(255,255,255,.18); }
header::after{
  content:"";
  display:block;
  height:1px;
  width:120px;
  margin:10px auto 0;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,.7), transparent);
  opacity:.6;
}

/* Tabs activas con oro metálico */
.tab.active{
  background: linear-gradient(135deg, var(--oro1), var(--oro2) 40%, var(--oro3));
  color:#201a00;
  border-color: rgba(255,255,255,.6);
  box-shadow: 0 0 0 1px rgba(255,255,255,.35) inset, 0 6px 18px rgba(255,215,0,.25);
}

/* Botones con borde metálico y brillo suave */
.btn{
  position: relative;
  background: linear-gradient(180deg, var(--oro2), var(--oro3));
  color:#201a00;
  border:1px solid rgba(255,255,255,.65);
  box-shadow:
    0 1px 0 rgba(255,255,255,.4) inset,
    0 -1px 0 rgba(0,0,0,.25) inset,
    0 8px 20px rgba(255,215,0,.25);
}
.btn:hover{
  filter: brightness(1.05);
  box-shadow:
    0 1px 0 rgba(255,255,255,.6) inset,
    0 -1px 0 rgba(0,0,0,.3) inset,
    0 10px 26px rgba(255,215,0,.35);
}

/* Precios resaltados con oro */
.price{
  color: var(--oro2);
  text-shadow: 0 1px 0 rgba(0,0,0,.35);
  font-weight: 800;
}

/* Tarjetas: borde fino “cromado” */
.card{
  border: 1px solid rgba(255,255,255,.28);
  box-shadow: 0 10px 28px rgba(0,0,0,.55), 0 0 0 1px rgba(255,255,255,.06) inset;
}

/* Animación del brillo en el texto dorado */
@keyframes goldSparkle{
  0%   { background-position: 0% 0; }
  100% { background-position: 200% 0; }
}

/* Respeta usuarios con reducción de movimiento */
@media (prefers-reduced-motion: reduce){
  header h1{ animation: none; background-position: 50% 0; }
}
/* ==== Efecto brillante tipo vidrio en el logo ==== */
header img{
  position: relative;
  overflow: hidden;
  border-radius: 12px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.4);
  transition: transform 0.4s ease, box-shadow 0.4s ease;
}

header img:hover{
  transform: scale(1.03);
  box-shadow: 0 6px 25px rgba(255,215,0,0.4);
}

/* Reflejo móvil */
header img::after{
  content: "";
  position: absolute;
  top: -100%;
  left: -75%;
  width: 50%;
  height: 300%;
  background: linear-gradient(
    120deg,
    rgba(255,255,255,0.05) 0%,
    rgba(255,255,255,0.3) 50%,
    rgba(255,255,255,0.05) 100%
  );
  transform: skewX(-25deg);
  animation: shineMove 6s ease-in-out infinite;
  pointer-events: none;
  border-radius: inherit;
}

/* Animación del reflejo */
@keyframes shineMove {
  0% { top: -120%; left: -75%; }
  50% { top: -50%; left: 100%; }
  100% { top: 120%; left: 200%; }
}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <img src="img/logo_optica_yolanda.png" alt="Óptica Yolanda" />
      <h1>Óptica Yolanda</h1>
      <div class="subtitle">Elige la sucursal y mira dirección, horarios, WhatsApp y catálogo.</div>
      <div class="pill">Versión con carga por sucursal</div>
    </header>

    <div class="tabs" id="tabs"></div>

    <div class="grid">
      <div class="card">
        <h3 id="branchTitle">Sucursal</h3>
        <div class="info">
          <div>
            <p class="muted"><strong>Dirección: </strong><span id="addr">—</span></p>
            <p class="muted"><strong>Horarios: </strong><span id="hours">—</span></p>
            <div class="actions">
              <a class="btn" id="wapp" target="_blank" rel="noopener">WhatsApp</a>
            </div>
          </div>
          <div style="min-height:200px">
            <div id="mapEmbed" style="height:200px;border-radius:12px;overflow:hidden;border:1px solid rgba(255,255,255,.25);display:flex;align-items:center;justify-content:center;color:#eee;font-size:13px;background:rgba(255,255,255,.05)">Mapa (opcional)</div>
          </div>
        </div>
        <hr style="border:0;border-top:1px solid rgba(255,255,255,.2);margin:16px 0"/>
        <h3>Productos de la sucursal</h3>
        <div class="products" id="products"></div>
        <div class="form-upload">
          <h4>Agregar producto</h4>
          <input type="text" id="prodName" placeholder="Nombre del producto" />
          <input type="text" id="prodPrice" placeholder="Precio (ej: ₲ 250.000)" />
          <input type="file" id="prodImage" accept="image/*" />
          <button id="uploadBtn">Cargar producto a esta sucursal</button>
          <div class="muted" style="font-size:12px">Las imágenes se guardan en el servidor y quedarán visibles para esta sucursal.</div>
        </div>
      </div>

      <div class="card">
        <h3>Contacto rápido</h3>
        <form id="contactForm">
          <label>Nombre<br/>
            <input name="name" required placeholder="Tu nombre" />
          </label>
          <label>Mensaje<br/>
            <textarea name="msg" required rows="4" placeholder="Quiero una cotización para…"></textarea>
          </label>
          <button class="btn" type="submit">Enviar por WhatsApp</button>
        </form>
        <hr style="border:0;border-top:1px solid rgba(255,255,255,.2);margin:16px 0"/>
        <h3>Sobre Óptica Yolanda</h3>
        <p class="muted">Especialistas en lentes, armazones y contacto. Examen visual y entrega rápida. Calidad al mejor precio.</p>
      </div>
    </div>

    <footer>
      <div>© <span id="year"></span> Óptica Yolanda. Todos los derechos reservados.</div>
      <div class="muted">Backend Express + Multer para carga por sucursal.</div>
    </footer>
  </div>

<script>
const BRANCHES = [
  { id:'central',  nombre:'Óptica Yolanda Central',  direccion:'Azara 1167 casi Brasil', horarios:'08:00 a 18:00', whatsapp:'595986315354' },
  { id:'fernando', nombre:'Óptica Yolanda Fernando de la Mora', direccion:'Ruta Mcal. José Estigarribia esquina 15 de Mayo', horarios:'08:00 a 18:00', whatsapp:'595983989860' },
  { id:'caacupe',  nombre:'Óptica Yolanda Caacupé', direccion:'Ruta del Maestro 1807 esquina Independencia Nacional', horarios:'08:00 a 18:00', whatsapp:'595972760646' }
];

const tabsEl = document.getElementById('tabs');
const productsEl = document.getElementById('products');
const branchTitle = document.getElementById('branchTitle');
const addr = document.getElementById('addr');
const hours = document.getElementById('hours');
const wapp = document.getElementById('wapp');
const uploadBtn = document.getElementById('uploadBtn');

let current = BRANCHES[0].id;

function renderTabs(){
  tabsEl.innerHTML = '';
  BRANCHES.forEach(b => {
    const btn = document.createElement('button');
    btn.className = 'tab' + (b.id===current?' active':'');
    btn.textContent = b.nombre;
    btn.onclick = () => { current = b.id; renderBranch(); };
    tabsEl.appendChild(btn);
  });
}

async function fetchProductos(){
  try{
    const r = await fetch(`/productos/${current}`);
    if(!r.ok) return {productos:[]};
    return await r.json();
  }catch(e){ return {productos:[]} }
}

async function renderBranch(){
  renderTabs();
  const b = BRANCHES.find(x=>x.id===current);
  branchTitle.textContent = b.nombre;
  addr.textContent = b.direccion;
  hours.textContent = b.horarios;
  wapp.href = `https://wa.me/${b.whatsapp}`;

  productsEl.innerHTML = '';
  const data = await fetchProductos();
  (data.productos||[]).forEach(p => {
    const card = document.createElement('div');
    card.className = 'product';
    card.innerHTML = `
      <img src="${p.img}" alt="${p.nombre}" />
      <div class="pbd">
        <div style="font-weight:700">${p.nombre}</div>
        <div class="price">${p.precio}</div>
      </div>`;
    productsEl.appendChild(card);
  });
}

document.getElementById('contactForm').addEventListener('submit', (e)=>{
  e.preventDefault();
  const b = BRANCHES.find(x=>x.id===current);
  const f = new FormData(e.target);
  const name = encodeURIComponent(f.get('name'));
  const msg  = encodeURIComponent(f.get('msg'));
  const text = `Hola, soy ${name}. ${msg}`;
  window.open(`https://wa.me/${b.whatsapp}?text=${text}`, '_blank');
});

uploadBtn.addEventListener('click', async ()=>{
  const name = document.getElementById('prodName').value.trim();
  const price = document.getElementById('prodPrice').value.trim();
  const file = document.getElementById('prodImage').files[0];
  if(!name || !price || !file){ alert('Completa nombre, precio e imagen'); return; }
  const fd = new FormData();
  fd.append('nombre', name);
  fd.append('precio', price);
  fd.append('imagen', file);
  const r = await fetch(`/upload/${current}`, { method:'POST', body: fd });
  if(r.ok){
    document.getElementById('prodName').value='';
    document.getElementById('prodPrice').value='';
    document.getElementById('prodImage').value='';
    renderBranch();
  }else{
    alert('No se pudo subir.');
  }
});

document.getElementById('year').textContent = new Date().getFullYear();
renderBranch();
</script>
</body>
</html>
